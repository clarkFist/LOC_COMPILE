# 🚗 LOC_COMPILE - VCU编译器启动器

> 🔧 一个用于简化MVCU和SVCU项目编译流程的工具  
> 支持图形界面和命令行两种模式，让VCU编译变得简单高效

---

## ✨ 功能特点

| 功能 | 描述 |
|------|------|
| 🔄 **自动环境配置** | 智能检测并创建项目目录结构 |
| 🛠️ **编译器路径管理** | 自动更新Makefile中的GCC/CW编译器路径 |
| ⚙️ **MSYS环境集成** | 自动配置MSYS profile，一键启动编译 |
| 🖥️ **双模式支持** | 提供GUI界面和命令行两种操作方式 |

---

## 📋 环境要求

### 系统要求
- 🖥️ **操作系统**: Windows 10/11
- 🐍 **Python版本**: 3.6 或更高版本

### 编译工具链
- 🔨 **GCC编译器工具链**
- ⚡ **ColdFire编译器 (CW)**
- 🐚 **MSYS-1.0.10-selftest环境**

---

## 🚀 快速开始

### 💨 一键环境设置

本项目提供了自动化的环境设置工具，让您快速开始使用：

#### Windows用户 (推荐)
```batch
# 双击运行或在命令行执行
setup_env.bat
```
etup_env.py
```

### 📦 依赖安装选项

项目提供了三种依赖安装方式：

| 📋 文件 | 🎯 用途 | 📝 说明 |
|---------|---------|---------|
| `requirements.txt` | 🛠️ 完整开发 | 包含开发工具和代码检查 |~~~~
| `setup_env.py` | 🤖 自动安装 | 智能检测并安装环境 |

```bash

# 完整安装 (开发者推荐)  
pip install -r requirements.txt

# 自动检测安装
python setup_env.py
```

---

## 📁 目录结构

确保以下目录与exe文件在同一级别：

```
📂 项目根目录/
├── 📁 LOC_COMPILE/                          # 本工具目录
├── 📁 GCC/bin/                              # GCC编译器
├── 📁 CW/ColdFire_Tools/Command_Line_Tools/ # ColdFire工具链
└── 📁 MSYS-1.0.10-selftest/                # MSYS环境
```

---

## 🎯 支持的项目类型

| 🏷️ 类型 | 🔍 识别规则 | 📍 目标目录 | 📝 说明 |
|---------|------------|------------|---------|
| **MVCU** | 文件名包含 `mvcu` | `dev_kernel_mvcu/src` | 主控制单元 |
| **SVCU** | 文件名包含 `svcu` | `dev_kernel_svcu/src` | 副控制单元 |

> ⚠️ **注意**: 文件名识别不区分大小写

### 📂 项目目录结构要求

**🚨 重要说明**: 选择的项目目录的下一级结构必须是具体的模块目录,且项目目录命名包含MVCU或者SVCU   (不区分大小写)

**正确的目录结构示例:**
```
📁 选择的项目目录 (如: MVCU118_Project)
├── 📁 WDG                    # 模块目录1
│   ├── 📄 wdg.c
│   ├── 📄 wdg.h
│   └── 📄 ...
├── 📁 API                    # 模块目录2  
│   ├── 📄 api.c
│   ├── 📄 api.h
│   └── 📄 ...
├── 📁 DRV                    # 模块目录3
│   └── 📄 ...
└── 📄 其他文件...
```

**错误的目录结构:**
```
❌ 选择的项目目录
    └── 📁 src                # 中间层目录 (不符合要求)
        ├── 📁 WDG            # 实际的模块目录
        └── 📁 API            # 实际的模块目录
```

> 💡 **提示**: 确保选择的目录直接包含 WDG、API、DRV 等功能模块子目录

---

## 📦 打包发布

```bash
# 一键打包为exe文件
python pack.py
```

📁 生成的exe文件位置: `dist/LOC_COMPILE_YYYYMMDD_HHMMSS.exe`

---

## ❓ 常见问题

### 🔧 编译器问题

**Q: ❌ 编译器未找到？**  
**A:** 
1. 确保GCC和CW目录在正确位置
2. 检查目录结构是否符合要求

### 🖥️ 界面问题

**Q: ❌ GUI无法启动？**  
**A:** 
1. 确保Python安装了tkinter模块
2. 或使用命令行模式：`python main.py --console`

### 🔍 识别问题

**Q: ❌ 文件名识别失败？**  
**A:** 
1. 确保文件名包含 `mvcu` 或 `svcu` 关键字
2. 检查文件名拼写是否正确（不区分大小写）

### 📂 目录结构问题

**Q: ❌ 目录结构不正确？**  
**A:** 
1. 确保选择的项目目录下直接包含模块目录（如 WDG、API、DRV）
2. 避免选择包含中间层目录（如 src）的路径
3. 参考上述"项目目录结构要求"章节的示例

### 🐚 环境问题

**Q: ❌ MSYS环境问题？**  
**A:** 
1. 检查 `MSYS-1.0.10-selftest` 目录是否存在
2. 确保 `msys.bat` 文件可访问
3. 检查文件权限设置

---

## 📂 项目结构

### 🔧 工具源码结构
```
📁 LOC_COMPILE/
├── 📄 main.py                 # 🚀 主程序入口
├── 🎨 vcu_compiler_ui.py      # 🖼️ GUI界面实现
├── 📦 pack.py                 # 📦 打包脚本
├── 🛠️ path_utils.py           # 📍 路径工具函数
├── 📚 README.md               # 📖 项目文档
└── 📋 requirements.txt        # 📝 依赖列表
```

### 🏗️ 自动生成的工作目录
```
📁 VCU_compile - selftest/
├── 📁 dev_kernel_mvcu/        # MVCU项目
│   ├── 📁 src/               # 源码目录
│   └── 📁 build/             # 构建目录
│       └── 📁 out/           # 输出目录
└── 📁 dev_kernel_svcu/        # SVCU项目
    ├── 📁 src/               # 源码目录
    └── 📁 build/             # 构建目录
        └── 📁 out/           # 输出目录
```

---

## 📞 获取帮助

遇到问题？请查看或者记录 [`bug_log.md`](bug_log.md) 文件获取更多故障排除信息。

---

